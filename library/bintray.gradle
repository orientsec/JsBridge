//apply plugin: 'com.jfrog.bintray'
//apply plugin: "com.jfrog.artifactory"
apply plugin: 'maven-publish'


def pomConfig = {
    licenses {
        license {
            name PROJ_LICENCE_NAME
            url PROJ_LICENCE_URL
            distribution PROJ_LICENCE_DIST
        }
    }
    developers {
        developer {
            id DEVELOPER_ID
            name DEVELOPER_NAME
            email DEVELOPER_EMAIL
        }
    }
}

afterEvaluate {
    publishing {
        publications {
            release(MavenPublication) {
                // The following applies a component to this publication
                // which results in publishing an app bundle.
                groupId = PROJ_GROUP
                artifactId = project.name
                version = PROJ_VERSION

                artifact(bundleReleaseAar)
                pom.withXml {
                    def root = asNode()
                    root.appendNode('description', PROJ_DESCRIPTION)
                    root.children().last() + pomConfig

                    def dependenciesNode = root.appendNode('dependencies')
                    configurations.api.allDependencies.each {
                        if (it.group && it.name && it.version) {
                            def dependencyNode = dependenciesNode.appendNode('dependency')
                            dependencyNode.appendNode('groupId', it.group)
                            dependencyNode.appendNode('artifactId', it.name)
                            dependencyNode.appendNode('version', it.version)
                        }
                    }
                }

            }
        }
    }
}